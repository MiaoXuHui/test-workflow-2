# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger: none
pr: none

name: $(TeamProject)_$(Build.DefinitionName)_$(SourceBranchName)_$(Date:yyyyMMdd)$(Rev:.r)

parameters:
- name: "platforms"
  type: object
  default:
  - vs
  - broadcom

stages:
- stage: Build
  pool:
    vmImage: 'ubuntu-latest'
  strategy:
    matrix:
      Python27:
        python.version: '2.7'
  jobs:
  - job: Test1
    steps:
    - script: |
        sudo pip install pytest==4.6.2 attrs==19.1.0 exabgp==4.0.10 distro==1.5.0 docker==4.4.1 redis==3.3.4 flaky==3.7.0
        which pytest
        cat $(which pytest)
        sudo python2 -m pytest -h
            echo test
  - template: multi-jobs-template.yml
    parameters:
      jobs:
      - job: Test
        condition: false
        steps:
        - script: |
            which pytest
            sudo pip2 install pytest==4.6.2 attrs==19.1.0 exabgp==4.0.10 distro==1.5.0 docker==4.4.1 redis==3.3.4 flaky==3.7.0
            which pytest
            cat $(which pytest)
            sudo python2 -m pytest -h
            echo test
  
